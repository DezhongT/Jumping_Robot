#include "elasticBendingForce.h"

elasticBendingForce::elasticBendingForce(elasticPlate &m_plate, timeStepper &m_stepper)
{
    plate = &m_plate;
    stepper = &m_stepper;

    Jbb = MatrixXd::Zero(6,6);
    flocal = VectorXd::Zero(6);

    localDOF = VectorXi::Zero(6);
}

elasticBendingForce::~elasticBendingForce()
{
	;
}

void elasticBendingForce::computeFb()
{
    for(int k = 0; k < plate->bendingNum; k++)
    {
        flocal = VectorXd::Zero(6);

        ind0 = plate->v_bendingElement[k].nv_1;
        ind1 = plate->v_bendingElement[k].nv_2;
        ind2 = plate->v_bendingElement[k].nv_3;

        p0 = plate->v_bendingElement[k].x_1;
        p  = plate->v_bendingElement[k].x_2;
        p1 = plate->v_bendingElement[k].x_3;

        xkm1 = p0[0];
        ykm1 = p0[1];
        xk = p[0];
        yk = p[1];
        xkp1 = p1[0];
        ykp1 = p1[1];

        l_k = plate->v_bendingElement[k].voroniLength;
        curvature0 = plate->v_bendingElement[k].nBar;
 
        localForce(); // populate flocal: first derivative of (curvature - curvature0)^2

        EI_local = plate->v_bendingElement[k].EI_local;

        flocal = (- 0.5 * EI_local / l_k) * flocal; // scale with stiffness

        localDOF = VectorXi::Zero(6);

        localDOF(0) = 2 * ind0 + 0;
        localDOF(1) = 2 * ind0 + 1;
        localDOF(2) = 2 * ind1 + 0;
        localDOF(3) = 2 * ind1 + 1;
        localDOF(4) = 2 * ind2 + 0;
        localDOF(5) = 2 * ind2 + 1;

        for (int i = 0; i < 6; i++)
        {
            stepper->addForce(localDOF(i), - flocal(i));
        }
    }
}


void elasticBendingForce::computeMoment()
{
    int k = plate->bendingNum - 1;

    ind0 = plate->v_bendingElement[k].nv_1;
    ind1 = plate->v_bendingElement[k].nv_2;
    ind2 = plate->v_bendingElement[k].nv_3;

    p0 = plate->v_bendingElement[k].x_1;
    p  = plate->v_bendingElement[k].x_2;
    p1 = plate->v_bendingElement[k].x_3;

    xkm1 = p0[0];
    ykm1 = p0[1];
    xk = p[0];
    yk = p[1];
    xkp1 = p1[0];
    ykp1 = p1[1];

    l_k = plate->v_bendingElement[k].voroniLength;
    curvature0 = plate->v_bendingElement[k].nBar;

    curvatureLocal = computeCurvature(xkm1, ykm1, xk, yk, xkp1, ykp1);

    boundaryMoment = plate->v_bendingElement[k].EI_local * (curvatureLocal - curvature0) / l_k;



    /*
    
    xkm1 = - 1.0;
    ykm1 = 0.0;
    xk = 0.0;
    yk = 0.1;
    xkp1 = 1.0;
    ykp1 = 0.0;

    curvature0 = 0.0;

    localForce();

    cout << flocal.transpose() << endl;

    */
}

void elasticBendingForce::computeJb()
{
    for(int k=0; k < plate->bendingNum; k++)
    {
        Jbb = MatrixXd::Zero(6,6);

        ind0 = plate->v_bendingElement[k].nv_1;
        ind1 = plate->v_bendingElement[k].nv_2;
        ind2 = plate->v_bendingElement[k].nv_3;

        p0 = plate->v_bendingElement[k].x_1;
        p  = plate->v_bendingElement[k].x_2;
        p1 = plate->v_bendingElement[k].x_3;

        xkm1 = p0[0];
        ykm1 = p0[1];
        xk = p[0];
        yk = p[1];
        xkp1 = p1[0];
        ykp1 = p1[1];

        l_k = plate->v_bendingElement[k].voroniLength;
        curvature0 = plate->v_bendingElement[k].nBar;

        localJacobian(); // populate Jbb: second derivative of (curvature - curvature0)^2
        
        EI_local = plate->v_bendingElement[k].EI_local;

        Jbb = (0.5 * EI_local / l_k) * Jbb; // scale with stiffness

        localDOF = VectorXi::Zero(6);

        localDOF(0) = 2 * ind0 + 0;
        localDOF(1) = 2 * ind0 + 1;
        localDOF(2) = 2 * ind1 + 0;
        localDOF(3) = 2 * ind1 + 1;
        localDOF(4) = 2 * ind2 + 0;
        localDOF(5) = 2 * ind2 + 1;

        for (int i = 0; i < 6; i++)
        {
            for(int j = 0; j < 6; j++)
            {
                stepper->addJacobian(localDOF(i), localDOF(j), Jbb(i,j));
            }
        }
    }
}

void elasticBendingForce::setFirstJacobian()
{
    for(int k=0; k < plate->bendingNum; k++)
    {
        ind0 = plate->v_bendingElement[k].nv_1;
        ind1 = plate->v_bendingElement[k].nv_2;
        ind2 = plate->v_bendingElement[k].nv_3;

        localDOF = VectorXi::Zero(6);

        localDOF(0) = 2 * ind0 + 0;
        localDOF(1) = 2 * ind0 + 1;
        localDOF(2) = 2 * ind1 + 0;
        localDOF(3) = 2 * ind1 + 1;
        localDOF(4) = 2 * ind2 + 0;
        localDOF(5) = 2 * ind2 + 1;

        for (int i = 0; i < 6; i++)
        {
            for (int j = 0; j < 6; j++)
            {
                stepper->addJacobian(localDOF(i), localDOF(j), 1);
            }
        }
    }
}

void elasticBendingForce::localForce()
{   
    flocal(0) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    flocal(1) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    flocal(2) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    flocal(3) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    flocal(4) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    flocal(5) = 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
}

void elasticBendingForce::localJacobian()
{
    Jbb(0,0) = 0.2e1 * pow((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(-xkp1 + xk, 0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - yk) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(0,1) = 0.2e1 * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) - pow(-xkp1 + xk, 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk) * (-ykp1 + yk)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(0,2) = 0.2e1 * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) - (-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk) * (xkp1 - 0.2e1 * xk + xkm1) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(0,3) = 0.2e1 * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) - (-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk) * (ykp1 - 0.2e1 * yk + ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkm1 + xkp1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(0,4) = 0.2e1 * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) - (yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk) * (xk - xkm1) + (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(0,5) = 0.2e1 * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (ykp1 - yk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-xkp1 + xk) * (yk - ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((ykp1 - yk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));

    Jbb(1,0) = Jbb(0,1);
    Jbb(1,1) = 0.2e1 * pow((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (-xkp1 + xk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(-ykp1 + yk, 0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(1,2) = 0.2e1 * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-xkp1 + xk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) - (-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk) * (xkp1 - 0.2e1 * xk + xkm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(1,3) = 0.2e1 * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(-xkp1 + xk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) - (-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk) * (ykp1 - 0.2e1 * yk + ykm1) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkm1 + xkp1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(1,4) = 0.2e1 * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-xkp1 + xk) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) - (yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk) * (xk - xkm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(1,5) = 0.2e1 * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkp1 + xk) - (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (-ykp1 + yk) * (yk - ykm1) + (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkp1 + xk) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + yk)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));

    Jbb(2,0) = Jbb(0,2);
    Jbb(2,1) = Jbb(1,2);
    Jbb(2,2) = 0.2e1 * pow((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(xkp1 - 0.2e1 * xk + xkm1, 0.2e1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-ykp1 + ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(2,3) = 0.2e1 * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) - (-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1) * (ykp1 - 0.2e1 * yk + ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkm1 + xkp1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(2,4) = 0.2e1 * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) - (yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1) * (xk - xkm1) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(2,5) = 0.2e1 * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-ykp1 + ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xkp1 - 0.2e1 * xk + xkm1) * (yk - ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-ykp1 + ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xkp1 - 0.2e1 * xk + xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));

    Jbb(3,0) = Jbb(0,3);
    Jbb(3,1) = Jbb(1,3);
    Jbb(3,2) = Jbb(2,3);
    Jbb(3,3) = 0.2e1 * pow((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(ykp1 - 0.2e1 * yk + ykm1, 0.2e1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xkm1 + xkp1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(3,4) = 0.2e1 * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (0.1e1 / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) - (yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1) * (xk - xkm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(3,5) = 0.2e1 * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-(-xkm1 + xkp1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (ykp1 - 0.2e1 * yk + ykm1) * (yk - ykm1) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xkm1 + xkp1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (ykp1 - 0.2e1 * yk + ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));

    Jbb(4,0) = Jbb(0,4);
    Jbb(4,1) = Jbb(1,4);
    Jbb(4,2) = Jbb(2,4);
    Jbb(4,3) = Jbb(3,4);
    Jbb(4,4) = 0.2e1 * pow((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (yk - ykm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(xk - xkm1, 0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    Jbb(4,5) = 0.2e1 * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-pow(yk - ykm1, 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) - (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (xk - xkm1) * (yk - ykm1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((yk - ykm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (xk - xkm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
    
    Jbb(5,0) = Jbb(0,5);
    Jbb(5,1) = Jbb(1,5);
    Jbb(5,2) = Jbb(2,5);
    Jbb(5,3) = Jbb(3,5);
    Jbb(5,4) = Jbb(4,5);
    Jbb(5,5) = 0.2e1 * pow((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * pow(0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1), 0.2e1) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * (-0.2e1 * (-xk + xkm1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1) + 0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * pow(yk - ykm1, 0.2e1)) / (pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) - 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * ((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1)) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1)) * (0.2e1 * (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (-xk + xkm1) - 0.2e1 * pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.3e1) * (yk - ykm1)) + 0.2e1 * (0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) - curvature0) * pow((-xk + xkm1) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk)) - (-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) * (yk - ykm1), 0.2e1) * pow(pow(-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk), 0.2e1) * pow((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk), -0.2e1) + 0.1e1, -0.2e1) * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1) * (0.1e1 + pow(tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1), 0.2e1));
}


double elasticBendingForce::computeCurvature(double xkm1, double ykm1, double xk, double yk, double xkp1, double ykp1)
{
    return 0.2e1 * tan(atan((-(xk - xkm1) * (ykp1 - yk) + (yk - ykm1) * (xkp1 - xk)) / ((xk - xkm1) * (xkp1 - xk) + (yk - ykm1) * (ykp1 - yk))) / 0.2e1);
}